<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Spiel Setup</title>
<style>
body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
    flex-direction: column;
}
input {
    padding: 10px;
    font-size: 18px;
    margin: 10px;
    width: 200px;
    text-align: center;
}
button {
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
    border: none;
    border-radius: 5px;
    background: gray;
    color: white;
    margin: 5px;
}
#coinsInput[readonly] {
    background: #444;
    color: #aaa;
}
#highscore[readonly] {
    background: #444;
    color: #aaa;
}
</style>
</head>
<body>
    <h1>General</h1>
<h2>Sprunglänge einstellen (default: 1200)</h2>
<input id="jumpDuration" type="number" min="0" value="0">
<h1>   </h1>
<h1>Hacks</h1>
<button id="unlockCoinsBtn" style="margin-left:10px;">entsperren</button>

<h2>Münzen für das Spiel einstellen</h2>
<div style="display:flex;align-items:center;">
    <input id="coinsInput" type="number" min="0" value="0" readonly>
</div>
<h2>Highscore einstellen</h2>
<div style="display:flex;align-items:center;">
    <input id="highscore" type="number" min="0" value="0" readonly>
</div>
</div>
<h2>Alle Skins löschen</h2>
<button onclick="deleteSkins()">löschen</button>
<h1>    </h1>
<div>
    <button onclick="apply()">Apply</button>
    <button onclick="ToMenu()">Zurück zum Menü</button>
</div>

<script>
async function sha256(str) {
    const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
    return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2, "0")).join("");
}

function apply() {
    const coins = parseInt(document.getElementById("coinsInput").value) || 0;
    const jumpDuration = parseInt(document.getElementById("jumpDuration").value) || 1200;
    const highscore = parseInt(document.getElementById("highscore").value) || 0;
    if (jumpDuration > 2500) {
        alert("Sprunglänge max 2500!");
        return; // Stop execution, do not save
    }
    localStorage.setItem("coins", coins);
    localStorage.setItem("jumpDuration", jumpDuration);
    localStorage.setItem("highscore", highscore);
}

function ToMenu() {
    window.location.href = "menu.html";
}

// Password-protect coins input
const coinsInput = document.getElementById("coinsInput");
const highscoreInput = document.getElementById("highscore");
const unlockBtn = document.getElementById("unlockCoinsBtn");

const PASSWORD_HASH = "1d604998daff644540f1390636ee61e88f8d1b2a83e04521e494d48ca272a6bc";

unlockBtn.addEventListener("click", async () => {
    let pwd = prompt("Passwort eingeben:");
    if (!pwd) return;
    const hash = await sha256(pwd);
    if (hash === PASSWORD_HASH) {
        coinsInput.readOnly = false;
        coinsInput.style.background = "#222";
        coinsInput.style.color = "#fff";
        highscoreInput.readOnly = false;
        highscoreInput.style.background = "#222";   
        highscoreInput.style.color = "#fff";
        alert("Enstsperrt!");
    } else {
        alert("Falsches Passwort!");
    }
});

function deleteSkins() {
    if (confirm("Willst du wirklich alle Skins löschen?")) {
        localStorage.removeItem("ownedSkins");
        localStorage.removeItem("activeSkin");
        alert("Alle Skins wurden gelöscht!");
    }
}

// Werte laden
document.addEventListener("DOMContentLoaded", () => {
    const savedCoins = parseInt(localStorage.getItem("coins")) || 0;
    const savedJumpDuration = parseInt(localStorage.getItem("jumpDuration")) || 1200;
    const savedhighscore = parseInt(localStorage.getItem("highscore")) || 0;
    
    document.getElementById("coinsInput").value = savedCoins;
    document.getElementById("jumpDuration").value = savedJumpDuration;
    document.getElementById("highscore").value = savedhighscore;
});
</script>
</body>
</html>